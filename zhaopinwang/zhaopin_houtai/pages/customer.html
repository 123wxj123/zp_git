
<div class="main">
	<!-- 用户管理 -->
	<div class="button row" style="margin-right:0px;margin-bottom:10px;">
	<input class="form-control-2" style="height:38px" type="text" id="input_job" name="job" placeholder="Please enter what you want....">
	<button id="search_job" type="button" class="btn btn-outline-primary" style="height:38px;border-radius: 0 5px 5px 0; border-left: none; ">查询</button>
	<button id="search_back" type="button" class="btn form-group btn-primary ml-2">返回</button>
	<!-- <button id="add_customer" type="button" class="btn form-group btn-primary ml-2">添加用户</button> -->
	<!-- <button id="add_customer" type="button" class="btn form-group btn-primary ml-2">导入用户</button> -->
	</div>
	<!-- </div> -->
	<!-- 标签页开始 -->
	<div class="layui-tab">
		<ul class="layui-tab-title">
			<li class="layui-this">用户列表</li>
		</ul>
	</div>
	<div class="layui-tab-content" style="margin-top: -10px ">
		<div class="layui-tab-item layui-show">
			<div class="row">
				<div class="form-group col-2">
			      <select id="one" class="form-control">
			        <option selected>学历</option>
			        <!-- <option>...</option> -->
			      </select>
		    	</div> 
		    	<div class="form-group col-2">
			      <select id="gender" class="form-control">
			        <option selected>性别</option>
			        <!-- <option>男</option> -->
			      </select>
		    	</div> 
		    	<!-- <button id="search_back" type="button" class="btn form-group btn-primary ml-1">返回</button> -->
		    	<button id="add_customer" type="button" class="btn form-group btn-primary ml-4" style="margin-left:15px;">添加用户</button>
				<!-- <button id="import_customer" type="button" class="btn form-group btn-primary ml-4">导入用户</button> -->
			</div>
		</div>
		<table id = "customer_tbl" class="table table-hover table-light">
		<thead>
			<tr>
			  <th scope="col">#</th>
			  <th scope="col">用户名</th>
			  <th scope="col">姓名</th> 
			  <th scope="col">手机</th>
			  <th scope="col">性别</th>
			  <th scope="col">出生日期</th>
			  <th scope="col">最高学历</th>
			  <th scope="col">操作</th>
			</tr>
		</thead>
		<tbody id="customer_tbl">
		</tbody>
		</table>
	</div>
	<!-- 标签页结束 -->
	<!-- 添加用户的模态框开始 -->
	<div class="modal fade" id="add_customer_modal" tabindex="-1">
	  <div class="modal-dialog modal-lg">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="addLabel">发布职位</h5>
	        <button type="button" class="close" onclick="closeAdd_customer_modal()">
	          <span>&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
			<form class="only" id="add_customer_form">
				<div class="row" style="padding:10px">
					<div class="col-6">
						<div class="row">
							<label class="col-4 text-right" for="input_tusername">用户名:</label>
							<div class="col">
								<input class="form-control" type="text" id="input_username" name="username" placeholder="">
							</div>
						</div>
					</div>
					<div class="col-6">
						<div class="row">
							<label class="col-4 text-right" for="input_realname">真实姓名:</label>
							<div class="col">
								<input class="form-control" type="text" id="input_realname" name="realname" placeholder="">
							</div>
						</div>
					</div>
				</div>
				<div class="row" style="padding:10px">
					<div class="col-6">
						<div class="row">
							<label class="col-4 text-right" for="input_password">密&nbsp;&nbsp;&nbsp;&nbsp;码:</label>
							<div class="col">
								<input class="form-control" type="text" id="input_password" name="password" placeholder="">
							</div>
						</div>
					</div>
					<div class="col-6">
						<div class="row">
							<label class="col-4 text-right" for="input_birth">出生日期:</label>
							<div class="col">
								<input class="form-control" type="text" id="input_birth" name="birth" placeholder="">
							</div>
						</div>
					</div>
				</div>
				<div class="row" style="padding:10px">
					<div class="col-6">
						<div class="row form-group">
							<label class="col-4 text-right">性&nbsp;&nbsp;&nbsp;&nbsp;别:</label>
							<div class="col-4">
								<div class="form-check form-check-inline">
									<input id="input_gender_male" class="form-check-input" type="radio" name="gender" value="男">
									<label class="form-check-label" for="input_gender_male">男</label>
								</div>
								<div class="form-check form-check-inline">
									<input id="input_gender_female" class="form-check-input" type="radio" name="gender" value="女">
									<label class="form-check-label" for="input_gender_female">女</label>
								</div>
							</div>
						</div>
					</div>
					<div class="col-6">
						<div class="row">
							<label class="col-4 text-right" for="input_telephone">联系方式:</label>
							<div class="col">
								<input class="form-control" type="text" id="input_telephone" name="telephone" placeholder="">
							</div>
						</div>
					</div>
				</div>
				<div class="row" style="padding:10px">
					<div class="col-6">
						<div class="row">
							<label class="col-4 text-right" for="input_education">学&nbsp;&nbsp;&nbsp;&nbsp;历:</label>
							<div class="col">
								<input class="form-control" type="text" id="input_seducation" name="education" placeholder=" ">
							</div>
						</div>
					</div>
					<div class="col-6">
						<div class="row">
							<label class="col-4 text-right" for="input_welfare">求职状态:</label>
							<div class="col">
								<input class="form-control" type="text" id="input_welfare" name="welfare" placeholder=" ">
							</div>
						</div>
					</div>
				</div>
				<div class="row" style="padding:10px">
					<label class="col-2 text-right" for="input_description">简&nbsp;&nbsp;&nbsp;&nbsp;历:</label>
					<div class="col">
						<textarea id="resume" name="resume" class="form-control" value = "resume">
						</textarea>
					</div>
				</div>
				<div class="row"  style="display:none">
				<label class="col-4 text-right" for="input_id">id:</label>
				<div class="col">
					<input class="form-control" type="text" id="input_id" name="id" placeholder=" ">
				</div>
			</div>
			</form>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-secondary" onclick="closeAdd_customer_modal()">取消</button>
	        <button type="button" class="btn btn-primary" id = "save">确定</button>
	      </div>
	    </div>
	  </div>
	</div>
	<!-- 添加用户的模态框结束 -->
</div>
<script>
$(function(){
    var baseURL = "http://203.195.246.58:7777";
	var data;
	$("#one").change(function(){
	 	var val = $(this).val()
	 	var obj={
	 		education:val
	 	}
	 	// $("#jobhunter_tbl tbody").empty();
	 	$("#customer_tbl tbody").empty();
	 	$.get(baseURL+"/Jobhunter/findByEducation",obj,function(response){
	 		data = response.data
	 		console.log(data);
	 		data.forEach(function(item,index){
	 			loadOption();
	 			$(`
	 				<tr>
	 				<td><input type="checkbox" value=`+item.id+`></td>
	 				<td>`+item.username+`</td>
	 				<td>`+item.realname+`</td>
	 				<td>`+item.telephone+`</td>
	 				<td>`+item.gender+`</td>
	 				<td>`+item.birth+`</td>
	 				<td>`+item.education+`</td>
	 				<td>
				  		<a class="btn_del" href="javascript:void(0)">
						<span class="btn_del fa fa-trash text-danger"></span>
						</a>
						<a class="btn_upd" href="javascript:void(0)">
						<span class="btn_upd fa fa-edit text-primary ml-3"></span>
						</a>
				  	</td>
	 				</tr>
	 			`).appendTo('tbody');
	 			// $('<option value='+item.education+'>'+item.education+'</option>').appendTo($('#one'))
	 		})
	 	})
	})
	$("#gender").change(function(){
	 	var val = $(this).val()
	 	var obj={
	 		gender:val
	 	}
	 	$("#customer_tbl tbody").empty();
	 	$.get(baseURL+"/Jobhunter/findByGender",obj,function(response){
	 		data = response.data
	 		console.log(data);
	 		data.forEach(function(item,index){
	 			loadOption();
	 			$(`
	 				<tr>
	 				<td><input type="checkbox" value=`+item.id+`></td>
	 				<td>`+item.username+`</td>
	 				<td>`+item.realname+`</td>
	 				<td>`+item.telephone+`</td>
	 				<td>`+item.gender+`</td>
	 				<td>`+item.birth+`</td>
	 				<td>`+item.education+`</td>
	 				<td>
				  		<a class="btn_del" href="javascript:void(0)">
						<span class="btn_del fa fa-trash text-danger"></span>
						</a>
						<a class="btn_upd" href="javascript:void(0)">
						<span class="btn_upd fa fa-edit text-primary ml-3"></span>
						</a>
				  	</td>
	 				</tr>
	 			`).appendTo('tbody');
	 			// $('<option value='+item.gender+'>'+item.gender+'</option>').appendTo($('#gender'));
	 		})
	 	})
	})
	function loadOption(){
	 	data.forEach(function(item,index){
	 		$('<option value='+item.education+'>'+item.education+'</option>').appendTo($('#one'))
	 	})
	 	data.forEach(function(item,index){
	 		$('<option value='+item.gender+'>'+item.gender+'</option>').appendTo($('#gender'))
	 	})
	}
	//保存按钮绑定事件
	$("#save").on("click",function(){
		// alert(1);
		//获取数据
		var id = $("input[name=id]").val();
		var username = $("input[name=username]").val();
		console.log("username",username);
		var realname = $("input[name=realname]").val();
		var password = $("input[name=password]").val();
		var education = $("input[name=education]").val();
		var gender = $("input[type=radio]:checked").val();
		var telephone = $("input[name=telephone]").val();
		var workTime = $("input[name=workTime]").val();
		var birth = $("input[name=birth]").val();
		var resume = $("textarea[name=resume]").val();
		//和后台交互
		var url = baseURL+"/Jobhunter/saveOrUpdate";
		var data = {
			id:id,
			username:username,
			realname:realname,
			password:password,
			education:education,
			gender:gender,
			telephone:telephone,
			workTime:workTime,
			birth:birth,
			resume:resume
		}
		$.post(url,data,function(response,status){
			loadOption();
			closeAdd_customer_modal();
			reloadJobhunter();
			alert("save successfully");
		})
	})
	//重载数据
	function reloadJobhunter(){
	 	$("#customer_tbl tbody").empty();
	 	var url = baseURL+"/Jobhunter/findAll";
	 	$.get(url,function(response,result){
	 		// console.log("response",response);
	 		response.data.forEach(function(item){
	 			$(`
	 				<tr>
	 				<td><input type="checkbox" value=`+item.id+`></td>
	 				<td>`+item.username+`</td>
	 				<td>`+item.realname+`</td>
	 				<td>`+item.telephone+`</td>
	 				<td>`+item.gender+`</td>
	 				<td>`+item.birth+`</td>
	 				<td>`+item.education+`</td>
	 				<td>
				  		<a class="btn_del" href="javascript:void(0)">
						<span class="btn_del fa fa-trash text-danger"></span>
						</a>
						<a class="btn_upd" href="javascript:void(0)">
						<span class="btn_upd fa fa-edit text-primary ml-3"></span>
						</a>
				  	</td>
	 				</tr>
	 			`).appendTo('tbody');
	 			$('<option value='+item.education+'>'+item.education+'</option>').appendTo($('#one'))
	 		})
	 	})
	 }
	 reloadJobhunter();
	 //为添加用户按钮绑定事件
	 $("#add_customer").on("click",function(){
	 	// alert(1);
	 	$("#add_customer_modal").modal("show");
	 })
	 //为查询返回按钮绑定事件
	 $("#search_back").on("click",function(){
	 	reloadJobhunter();
	 })
	 //修改 删除
	 $("#customer_tbl").on("click","a",function(){
	 	// alert(1);
	 	switch(this.className){
	 		case "btn_del":
	 		// alert(2);
	 		//获取要删除的id
	 		var id = $(this).parents("tr").children().find("input").val();
	 		console.log("delid",id);
	 		//和后台交互
	 		var url= baseURL+"/Jobhunter/deleteById";
	 		var data = {
	 			id:id
	 		}
	 		$.post(url,data,function(result){
	 			if(result.status===200){
	 				alert("deleted successfully");
	 				reloadJobhunter();
	 			}else{
	 				alert(result.message);
	 			}
	 		})
	 		break;
	 		case "btn_upd":
	 		// alert(3);
	 		//获取数据
	 		$("#add_customer_modal").modal("show");
	 		var id = $(this).parents("tr").children().eq(0).find("input").val();
	 		console.log("huoquid",id);
	 		var username = $(this).parents("tr").children().eq(1).text();
	 		console.log("username",username);
	 		var realname = $(this).parents("tr").children().eq(2).text();
	 		console.log("realname",realname);
	 		// var password = $(this).parents("tr").children().eq(3).text();
	 		// console.log("password",password);
	 		var education = $(this).parents("tr").children().eq(6).text();
	 		console.log("education",education);
	 		var telephone = $(this).parents("tr").children().eq(3).text();
	 		console.log("telephone",telephone);
	 		var gender = $(this).parents("tr").children().eq(4).text();
	 		console.log("gender",gender);
	 		var birth = $(this).parents("tr").children().eq(5).text();
	 		console.log("birth",birth);
	 		//设置值
	 		$("#add_customer_form input[name=id]").val(id);
	 		$("#add_customer_form input[name=username]").val(username);
	 		$("#add_customer_form input[name=realname]").val(realname);
	 		$("#add_customer_form input[name=education]").val(education);
	 		$("#add_customer_form input[type=radio]:checked").val(gender);
	 		$("#add_customer_form input[name=telephone]").val(telephone);
	 		$("#add_customer_form input[name=birth]").val(birth);
	 		break;
	 	}
	 })

})
 //关闭模态框
 function closeAdd_customer_modal(){
 	$("#add_customer_modal").modal("hide");
 }
</script>
<style>
	.button{
		float: right;
		margin-top: 70px;
		margin-right: 10px;
	}
	.col-md-1{
		padding-left: 0px;
	}
	.layui-tab-content{
		padding: 10px 0 0 0;
	}
	#add_customer_modal{
		margin-top: 40px;
	}
	.modal-backdrop.show{
		z-index: -1;
	}
	label{
		line-height: 38px;
	}
	.form-group{
		margin-bottom: 0px;
	}
	thead{
		background-color: #1d2b36;
		color: #fff;
	}
	.col-2{
		padding-left: 0px;
	}
	.ml-4{
		margin-left: 0px !important;
	}
	.ml-4{
		padding-left: 15px !important;
	}
	table{
		text-align: center;
	}
</style>

 